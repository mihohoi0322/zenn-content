---
title: "Terraform ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Terraform]
published: false
---
Terraform ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¤‡æ•°å‹•ã‹ã—ãŸãã¦ã€pyenv ã®ã‚ˆã†ãªã‚‚ã®ãŒãªã„ã‹æ¢ã—ãŸã¨ã“ã‚ã€`tfenv`ã¨ã„ã†ã‚‚ã®ãŒã‚ã£ãŸã®ã§ã€è©¦ã—ã¦ã¿ãŸã€‚

**tfenv:**
https://github.com/tfutils/tfenv

ãªã‚“ã¨ã€Applie Silicon ã‚‚å¯¾å¿œã—ã¦ã„ã‚‹ï¼ã‚ã‚ŠãŒãŸã‚„...ç§ãŒä½¿ç”¨ã—ãŸ PC ã¯ M2 Macbook Air (Apple Silicon) ã§ã™ã€‚

# Install

ã¾ãšã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‹ã‚‰ã ã‚ã†ã€ã¨æ€ã£ã¦å‹¢ã„ã‚ˆãè©¦ã—ãŸã¨ã“ã‚ã€å¤±æ•—ã—ãŸã€‚
```bash
% brew install tfenv
(ç•¥)
Error: Cannot install tfenv because conflicting formulae are installed.
  terraform: because tfenv symlinks terraform binaries

Please `brew unlink terraform` before continuing.

Unlinking removes a formula's symlinks from /opt/homebrew. You can
link the formula again after the install finishes. You can --force this
install, but the build may fail or cause obscure side effects in the
resulting software.
```

æ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹ terraform ã‚’ unlink ã—ã¦ã»ã—ã„ã¨ã„ã†ã“ã¨ã ã£ãŸã€‚
```bash
% brew unlink terraform
Unlinking /opt/homebrew/Cellar/terraform/1.3.7... 1 symlinks removed.
```

unlink ã—ãŸã¨ã“ã‚ã§å†åº¦ãƒˆãƒ©ã‚¤
```bash
% brew install tfenv
==> Fetching dependencies for tfenv: grep
==> Fetching grep
==> Downloading https://ghcr.io/v2/homebrew/core/grep/manifests/3.8_1
(ç•¥)
==> Running `brew cleanup tfenv`...
Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.
Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).
```

ã‚³ãƒãƒ³ãƒ‰ãŒæˆåŠŸã—ãŸã®ã§ã€ä½¿ç”¨ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
```bash
% tfenv
tfenv 3.0.0
Usage: tfenv <command> [<options>]

Commands:
   install       Install a specific version of Terraform
   use           Switch a version to use
   uninstall     Uninstall a specific version of Terraform
   list          List all installed versions
   list-remote   List all installable versions
   version-name  Print current version
   init          Update environment to use tfenv correctly.
   pin           Write the current active version to ./.terraform-version
```

# How to use?
ç•°ãªã‚‹ Terraform ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥ã‚Œã‚‹å ´åˆã¯ã€è©²å½“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚Œã°è‰¯ã„ã€‚
```bash
% tfenv install 1.3.5 // v1.3.5 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
Installing Terraform v1.3.5
(ç•¥)
Installation of terraform v1.3.5 successful. To make this your default version, run 'tfenv use 1.3.5'
% terraform --version // ã“ã“ã§ã¯ã¾ã åˆ‡ã‚Šæ›¿ãˆã¦ã„ãªã„ã®ã§ã€ã‚‚ã¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹
Terraform v1.3.7
on darwin_arm64
+ provider registry.terraform.io/hashicorp/azurerm v3.34.0
% tfenv use 1.3.5 // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
Switching default version to v1.3.5
Default version (when not overridden by .terraform-version or TFENV_TERRAFORM_VERSION) is now: 1.3.5
```

ã“ã“ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹ã¨ã€æŒ‡å®šã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³(v1.3.7 -> v1.3.5)ã«åˆ‡ã‚Šæ›¿ã‚ã£ãŸã“ã¨ãŒç¢ºèªã§ãã‚‹ã€‚
```bash
% terraform --version
Terraform v1.3.5
on darwin_arm64
+ provider registry.terraform.io/hashicorp/azurerm v3.34.0

Your version of Terraform is out of date! The latest version
is 1.3.7. You can update by downloading from https://www.terraform.io/downloads.html
```

# Other Command

## 1. ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’çŸ¥ã‚ŠãŸã„
```bash
% tfenv list
  1.3.7
* 1.3.5 (set by /opt/homebrew/Cellar/tfenv/3.0.0/version)
```
ä¸Šè¨˜ã®å ´åˆã ã¨ã€2ã¤ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå­˜åœ¨ã—ã¦ãŠã‚Šã€ç¾çŠ¶æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ãŒ `*` ãŒã¤ã„ã¦ã„ã‚‹ 1.3.5 ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚

## 2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’çŸ¥ã‚ŠãŸã„
```bash
% tfenv list-remote
1.4.0-alpha20221207
1.4.0-alpha20221109
1.3.7
1.3.6
1.3.5
1.3.4
(ç•¥)
```

## 3. ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„
```bash
% tfenv uninstall 1.3.5
Uninstall Terraform v1.3.5
Terraform v1.3.5 is successfully uninstalled
```

ã“ã“ã§å°‘ã—æ°—ã«ãªã£ã¦ã€current version ã‚’æŒ‡å®šã—ãŸã‚‰ã©ã®ã‚ˆã†ãªå‹•ãã«ãªã‚‹ã®ã‹ãŒæ°—ã«ãªã£ãŸã®ã§ã€è©¦ã—ã¦ã¿ãŸã€‚
```bash
% tfenv list
  1.3.7
* 1.3.5 (set by /opt/homebrew/Cellar/tfenv/3.0.0/version)
% tfenv uninstall 1.3.5
Uninstall Terraform v1.3.5
Terraform v1.3.5 is successfully uninstalled
% tfenv list
  1.3.7
No default set. Set with 'tfenv use <version>'
```
ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã‹ã¨æ€ã£ãŸãŒã€ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã€‚ãŸã ã€`*` ã¯ãªããªã£ã¦ã—ã¾ã£ãŸã®ã§ã€ç¾åœ¨ã® Terraform ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã©ã†ãªã£ãŸã®ã‹ã¨ã„ã†ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ãŸã€‚
```bash
% terraform --version
version '1.3.5' is not installed (set by /opt/homebrew/Cellar/tfenv/3.0.0/version). Installing now as TFENV_AUTO_INSTALL==true
Installing Terraform v1.3.5
Downloading release tarball from https://releases.hashicorp.com/terraform/1.3.5/terraform_1.3.5_darwin_arm64.zip
################################################################################################################################################################# 100.0%
Downloading SHA hash file from https://releases.hashicorp.com/terraform/1.3.5/terraform_1.3.5_SHA256SUMS
Not instructed to use Local PGP (/opt/homebrew/Cellar/tfenv/3.0.0/use-{gpgv,gnupg}) & No keybase install found, skipping 
(ç•¥)
Installation of terraform v1.3.5 successful. To make this your default version, run 'tfenv use 1.3.5'
Terraform v1.3.5
on darwin_arm64
+ provider registry.terraform.io/hashicorp/azurerm v3.34.0

Your version of Terraform is out of date! The latest version
is 1.3.7. You can update by downloading from https://www.terraform.io/downloads.html
```
ã©ã†ã‚„ã‚‰ã€`/opt/homebrew/Cellar/tfenv/3.0.0/version` ã‚’è¦‹ã«è¡Œã£ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ¢ã—ã¦ã„ã‚‹ã‚ˆã†ãªå‹•ãã‚’ã—ã¦ã„ã‚‹ã€‚è¨˜è¼‰ã‚’ç¢ºèªã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ãŸã€‚
```bash
% cat /opt/homebrew/Cellar/tfenv/3.0.0/version
1.3.5
```

ç¾çŠ¶ã‚’ç¢ºèªã™ã‚‹ã¨ã€ãªã‚‹ã»ã© v1.3.5 ã¨ãªã£ã¦ã„ã‚‹ã€‚
```bash
% terraform --version
Terraform v1.3.5
on darwin_arm64
+ provider registry.terraform.io/hashicorp/azurerm v3.34.0

Your version of Terraform is out of date! The latest version
% tfenv list
  1.3.7
* 1.3.5 (set by /opt/homebrew/Cellar/tfenv/3.0.0/version)
```

# ãŠã‚ã‚Šã«
ğŸ‰ã€€tfenv ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è¤‡æ•°ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€ç°¡å˜ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚
ğŸ‰ã€€Terraform ã¯å®Ÿè¡Œæ™‚ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æŒ‡å®šã¯ã§ãã‚‹ã‚‚ã®ã®ã€"xx ä»¥ä¸Š" ã®ã‚ˆã†ãªæ›¸ãæ–¹ã‚’ã™ã‚‹ã®ã§ã€å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å‹•ä½œãŒå¿…è¦ã«ãªã£ãŸæ™‚ã«ä¾¿åˆ©ã€‚
